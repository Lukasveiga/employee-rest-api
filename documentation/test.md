### Unit and Integration tests:

  #### Unit tests:
  - To test the repository layer, the h2 in-memory database was used to avoid changes in the original database.
  It is then necessary to use the framework's @DataJpaTest annotation where tests with this annotation are transactional and roll back at the end of each test.
  
 H2 database setup:
  ```
spring.datasource.url=jdbc:h2:mem:db;DB_CLOSE_DELAY=-1
spring.datasource.username=sa
spring.datasource.password=sa
spring.datasource.driver-class-name=org.h2.Driver

jpa.properties.hibernate.dialect=org.hibernate.dialect.H2Dialect
jpa.properties.show-sql=true

jpa.hibernate.ddl-auto=create-drop
  ```
 `Obs`: It is necessary to create a resource folder in the test directory, create a .properties file and insert the above information to configure the database of data in memory.
 
 - In the service layer, the mockito framework was used to carry out the tests, making it possible to mock the repository layer necessary for the tests
 from the service layer. The purpose of using this framework is that there is no need to use a concrete database since the repository layer has already been tested. The goal of unit testing is to isolate as much of each section to be tested as possible.<br>
 To carry out the tests, it is necessary to use the @ExtendWith annotation of the Junit framework and pass the MockitoExtension class as a parameter, so it will be possible
 mock the service layer and simulate its behavior.
 
- To test the controller layer, it is necessary to use the @WebMvcTest annotation, which will fire up an application context that contains only the beans needed for testing a web controller and pass the controller class that you want to be tested as a parameter. <br>
One of the resources that comes with the context generated by spring is the MockMvc responsible for simulating HTTP requests; and finally mock the service layer to access the application's business logic.

##### Unit Test Coverage:
| Layer         | Coverage      |
| ------------- | ------------- |
| Repository    |      100%     | 
| Service       |      100%     | 
| Controller    |      100%     |

#### Integration Test:
- In the integration test it is necessary to load all the context around the controller layer, with the exception of the database that cannot be changed during the tests, for this you can create a new table with the same structure as the original table only with the purpose of testing or reuse the in-memory database as demonstrated in the repository layer unit test topic. <br>
- It is necessary to annotate the test class with @SpringBootTest, by default the framework does not load a web application environment for that you need to pass a web environment with the mock as a parameter, it doesn't load a real http server, just mocks the entire web server behavior.<br>
- Finally, you need to perform the necessary dependency injections and run the tests.

 ##### Integration Test Coverage:
| Components        | Coverage      |
| ------------- | ------------- |
| Class    |      87%     | 
| Method    |      81%     |
| Line    |      78%     |


[Back](https://github.com/Lukasveiga/employee-rest-api)
 
